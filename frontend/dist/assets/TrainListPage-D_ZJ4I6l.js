const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/trainService-BTylc42G.js","assets/index-73FoUPY2.js","assets/index-hL2z1VQu.css","assets/HomePage-DWFL5Tu-.css"])))=>i.map(i=>d[i]);
import{r as j,j as e,a as q,u as J,_ as X}from"./index-73FoUPY2.js";/* empty css                 */const ee="",se={headers:{"Content-Type":"application/json"}},F=async(l,r={})=>{const u=localStorage.getItem("authToken"),N={...r,headers:{...se.headers,...u&&{Authorization:`Bearer ${u}`},...r.headers}},x=await fetch(`${ee}${l}`,N),m=await x.json().catch(()=>({}));if(!x.ok)throw new Error((m==null?void 0:m.message)||`HTTP error! status: ${x.status}`);return m},ae=l=>F(l,{method:"GET"}),B=(l,r)=>F(l,{method:"POST",body:r?JSON.stringify(r):void 0}),te=l=>{localStorage.setItem("authToken",l)},ne=()=>{localStorage.removeItem("authToken")},re=async l=>{var u;const r=await B("/auth/login",l);return r.success&&((u=r.data)!=null&&u.token)&&te(r.data.token),r},ie=async()=>await ae("/auth/me"),le=async()=>{try{await B("/auth/logout")}catch{}finally{ne()}},oe=()=>!!localStorage.getItem("authToken"),G=j.createContext(void 0),ce=({children:l})=>{const[r,u]=j.useState(null),[N,x]=j.useState(!0),m=(a,g)=>{u(a),localStorage.setItem("authToken",g)},v=async()=>{try{await le()}catch{}finally{u(null),localStorage.removeItem("authToken")}},p=async()=>{if(!oe()){u(null),x(!1);return}try{const a=await ie();a.success&&a.data?u(a.data.user):(u(null),localStorage.removeItem("authToken"))}catch{u(null),localStorage.removeItem("authToken")}finally{x(!1)}};j.useEffect(()=>{p()},[]);const S={user:r,isLoggedIn:!!r,isLoading:N,login:m,logout:v,refreshUser:p};return e.jsx(G.Provider,{value:S,children:l})},K=()=>{const l=j.useContext(G);return l===void 0?{user:null,isLoggedIn:!1,isLoading:!1,login:()=>{},logout:async()=>{},refreshUser:async()=>{}}:l},M={åŒ—äº¬:["åŒ—äº¬å—","åŒ—äº¬è¥¿"],ä¸Šæµ·:["ä¸Šæµ·","ä¸Šæµ·è™¹æ¡¥"],å—äº¬:["å—äº¬å—"],å¹¿å·ž:["å¹¿å·žå—"],æ·±åœ³:["æ·±åœ³åŒ—"],è¥¿å®‰:["è¥¿å®‰åŒ—"]};Object.entries(M).forEach(([l,r])=>{r.forEach(u=>{})});const de=l=>{if(M[l])return M[l];const r=Object.keys(M).find(u=>u.includes(l)||l.includes(u));return r?M[r]:[]},R=l=>{const r=de(l);return r.length>0?{isCity:!0,city:l,stations:r}:{isCity:!1,stations:[l]}},he=({fromStation:l,toStation:r,departDate:u,passengerType:N,trainType:x,onConditionsChange:m,onStationFilterChange:v,returnDate:p="",tripType:S="single"})=>{const[a,g]=j.useState({fromStation:l,toStation:r,departDate:u,returnDate:p,passengerType:N,trainType:x,tripType:S}),[T,b]=j.useState(""),k=j.useCallback(()=>{const o=R(a.fromStation),y=R(a.toStation),E={};return o.isCity&&(E.fromStations=o.stations),y.isCity&&(E.toStations=y.stations),E},[a.fromStation,a.toStation]),s=()=>new Date().toISOString().split("T")[0],n=()=>{const o=new Date;return o.setDate(o.getDate()+30),o.toISOString().split("T")[0]},i=()=>{const o={...a,fromStation:a.toStation,toStation:a.fromStation};g(o)},h=o=>{const y={...a,departDate:o};g(y)},C=o=>{const y={...a,passengerType:o};g(y)},D=o=>{const y={...a,tripType:o,returnDate:o==="single"?"":a.returnDate};g(y)},_=o=>{const y={...a,returnDate:o};g(y)},A=o=>{const y={...a,fromStation:o};g(y),T&&o.trim()&&y.toStation.trim()&&b("")},$=o=>{const y={...a,toStation:o};g(y),T&&o.trim()&&y.fromStation.trim()&&b("")},O=()=>{if(!a.fromStation.trim()||!a.toStation.trim()){b("è¯·å¡«å†™å‡ºå‘åœ°å’Œç›®çš„åœ°");return}b("");const o=k();(o.fromStations||o.toStations)&&(v==null||v(o)),m==null||m(a)};return e.jsx("div",{className:"search-conditions",children:e.jsxs("div",{className:"search-main",children:[e.jsxs("div",{className:"trip-type-column",children:[e.jsxs("label",{className:"trip-type-item",children:[e.jsx("input",{type:"radio",name:"tripType",value:"single",checked:a.tripType==="single",onChange:()=>D("single")}),"å•ç¨‹"]}),e.jsxs("label",{className:"trip-type-item",children:[e.jsx("input",{type:"radio",name:"tripType",value:"round",checked:a.tripType==="round",onChange:()=>D("round")}),"å¾€è¿”"]})]}),e.jsxs("div",{className:"station-selector",children:[e.jsxs("div",{className:"station-item",children:[e.jsx("label",{children:"å‡ºå‘åœ°"}),e.jsx("input",{type:"text",className:`station-input ${T&&!a.fromStation.trim()?"invalid":""}`,placeholder:"è¯·é€‰æ‹©",value:a.fromStation,onChange:o=>A(o.target.value)})]}),e.jsx("button",{className:"swap-button",onClick:i,title:"äº¤æ¢å‡ºå‘åœ°å’Œç›®çš„åœ°",children:"â‡„"}),e.jsxs("div",{className:"station-item",children:[e.jsx("label",{children:"ç›®çš„åœ°"}),e.jsx("input",{type:"text",className:`station-input ${T&&!a.toStation.trim()?"invalid":""}`,placeholder:"è¯·é€‰æ‹©",value:a.toStation,onChange:o=>$(o.target.value)})]})]}),e.jsxs("div",{className:"date-selector",children:[e.jsx("label",{children:"å‡ºå‘æ—¥æœŸ"}),e.jsx("input",{id:"departure-date",type:"date",className:"date-input",value:a.departDate,min:s(),max:n(),onChange:o=>h(o.target.value)})]}),e.jsxs("div",{className:`date-selector ${a.tripType==="single"?"disabled":""}`,children:[e.jsx("label",{children:"è¿”ç¨‹æ—¥æœŸ"}),e.jsx("input",{id:"return-date",type:"date",className:"date-input",value:a.returnDate,min:a.departDate||s(),max:n(),onChange:o=>_(o.target.value),disabled:a.tripType==="single"})]}),e.jsxs("div",{className:"passenger-type-selector",children:[e.jsx("label",{children:"ä¹˜å®¢ç±»åž‹"}),e.jsxs("div",{className:"radio-group",children:[e.jsxs("label",{className:"radio-item",children:[e.jsx("input",{type:"radio",name:"passengerType",value:"adult",checked:a.passengerType==="adult",onChange:()=>C("adult")}),"æˆäºº"]}),e.jsxs("label",{className:"radio-item",children:[e.jsx("input",{type:"radio",name:"passengerType",value:"student",checked:a.passengerType==="student",onChange:()=>C("student")}),"å­¦ç”Ÿ"]})]})]}),e.jsx("button",{className:"search-button",onClick:O,children:"æŸ¥è¯¢"}),T&&e.jsx("div",{className:"form-error",role:"alert","aria-live":"polite",children:T})]})})},me=({onFiltersChange:l,currentDate:r,fromStation:u,toStation:N,availableDepartureStations:x=[],availableArrivalStations:m=[],onDateSelect:v})=>{const[p,S]=j.useState({departureTime:"00:00-24:00",trainTypes:[],departureStations:[],arrivalStations:[],seatTypes:[]}),a=j.useMemo(()=>{const s=[],n=new Date(r),i=["å‘¨æ—¥","å‘¨ä¸€","å‘¨äºŒ","å‘¨ä¸‰","å‘¨å››","å‘¨äº”","å‘¨å…­"];for(let h=0;h<14;h++){const C=new Date(n);C.setDate(n.getDate()+h);const D=C.getFullYear(),_=String(C.getMonth()+1).padStart(2,"0"),A=String(C.getDate()).padStart(2,"0"),$=`${D}-${_}-${A}`,O=`${_}-${A}`,o=i[C.getDay()];s.push({date:$,label:O,weekday:o})}return s},[r]),g=[{value:"all",label:"å…¨éƒ¨"},{value:"GC",label:"GC-é«˜é“/åŸŽé™…"},{value:"D",label:"D-åŠ¨è½¦"},{value:"Z",label:"Z-ç›´è¾¾"},{value:"T",label:"T-ç‰¹å¿«"},{value:"K",label:"K-å¿«é€Ÿ"},{value:"other",label:"å…¶ä»–"},{value:"fuxing",label:"å¤å…´å·"},{value:"smart",label:"æ™ºèƒ½åŠ¨è½¦ç»„"}],T=[{value:"business",label:"å•†åŠ¡åº§"},{value:"first_class_premium",label:"ä¼˜é€‰ä¸€ç­‰åº§"},{value:"first_class",label:"ä¸€ç­‰åº§"},{value:"second_class",label:"äºŒç­‰åº§"},{value:"first_sleeper",label:"ä¸€ç­‰å§"},{value:"second_sleeper",label:"äºŒç­‰å§"},{value:"soft_sleeper",label:"è½¯å§"},{value:"hard_sleeper",label:"ç¡¬å§"},{value:"hard_seat",label:"ç¡¬åº§"}],b=["00:00-24:00","00:00-06:00","06:00-12:00","12:00-18:00","18:00-24:00"],k=s=>{const n={...p,...s};S(n),l==null||l(n)};return e.jsxs("div",{className:"filter-conditions horizontal",children:[e.jsxs("div",{className:"date-strip",children:[a.map(s=>e.jsxs("button",{className:`date-item ${s.date===r?"active":""}`,onClick:()=>v==null?void 0:v(s.date),children:[e.jsx("div",{className:"date-label",children:s.label}),e.jsx("div",{className:"date-weekday",children:s.weekday})]},s.date)),e.jsxs("div",{className:"time-range",children:[e.jsx("label",{className:"time-label",children:"å‘è½¦æ—¶é—´:"}),e.jsx("select",{className:"time-select",value:p.departureTime,onChange:s=>k({departureTime:s.target.value}),children:b.map(s=>e.jsx("option",{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"filter-line",children:[e.jsx("span",{className:"line-label",children:"è½¦æ¬¡ç±»åž‹:"}),e.jsx("div",{className:"line-options",children:g.map(s=>e.jsxs("label",{className:"line-option",children:[e.jsx("input",{type:"checkbox",checked:p.trainTypes.includes(s.value),onChange:n=>{const i=n.target.checked,h=new Set(p.trainTypes);i?h.add(s.value):h.delete(s.value),k({trainTypes:Array.from(h)})}}),e.jsx("span",{children:s.label})]},s.value))})]}),!!u&&x.length>0&&e.jsxs("div",{className:"filter-line",children:[e.jsx("span",{className:"line-label",children:"å‡ºå‘è½¦ç«™:"}),e.jsxs("div",{className:"line-options",children:[e.jsxs("label",{className:"line-option",children:[e.jsx("input",{type:"checkbox",checked:p.departureStations.includes("all"),onChange:s=>{const n=s.target.checked,i=new Set(p.departureStations);n?i.add("all"):i.delete("all"),k({departureStations:Array.from(i)})}}),e.jsx("span",{children:"å…¨éƒ¨"})]}),x.map(s=>e.jsxs("label",{className:"line-option",children:[e.jsx("input",{type:"checkbox",checked:p.departureStations.includes(s),onChange:n=>{const i=n.target.checked,h=new Set(p.departureStations);i?h.add(s):h.delete(s),k({departureStations:Array.from(h)})}}),e.jsx("span",{children:s})]},s))]})]}),!!N&&m.length>0&&e.jsxs("div",{className:"filter-line",children:[e.jsx("span",{className:"line-label",children:"åˆ°è¾¾è½¦ç«™:"}),e.jsxs("div",{className:"line-options",children:[e.jsxs("label",{className:"line-option",children:[e.jsx("input",{type:"checkbox",checked:p.arrivalStations.includes("all"),onChange:s=>{const n=s.target.checked,i=new Set(p.arrivalStations);n?i.add("all"):i.delete("all"),k({arrivalStations:Array.from(i)})}}),e.jsx("span",{children:"å…¨éƒ¨"})]}),m.map(s=>e.jsxs("label",{className:"line-option",children:[e.jsx("input",{type:"checkbox",checked:p.arrivalStations.includes(s),onChange:n=>{const i=n.target.checked,h=new Set(p.arrivalStations);i?h.add(s):h.delete(s),k({arrivalStations:Array.from(h)})}}),e.jsx("span",{children:s})]},s))]})]}),e.jsxs("div",{className:"filter-line",children:[e.jsx("span",{className:"line-label",children:"è½¦æ¬¡å¸­åˆ«:"}),e.jsx("div",{className:"line-options",children:T.map(s=>e.jsxs("label",{className:"line-option",children:[e.jsx("input",{type:"checkbox",checked:p.seatTypes.includes(s.value),onChange:n=>{const i=n.target.checked,h=new Set(p.seatTypes);i?h.add(s.value):h.delete(s.value),k({seatTypes:Array.from(h)})}}),e.jsx("span",{children:s.label})]},s.value))})]})]})},ue=({trains:l,onTrainSelect:r})=>{const[u,N]=j.useState("departure"),[x,m]=j.useState("asc"),v=[{key:"business",label:"å•†åŠ¡åº§",shortLabel:"å•†åŠ¡"},{key:"firstClassPlus",label:"ç‰¹ç­‰åº§",shortLabel:"ç‰¹ç­‰"},{key:"firstClassPremium",label:"ä¼˜é€‰ä¸€ç­‰åº§",shortLabel:"ä¼˜é€‰ä¸€ç­‰"},{key:"firstClass",label:"ä¸€ç­‰åº§",shortLabel:"ä¸€ç­‰"},{key:"secondClass",label:"äºŒç­‰åº§",shortLabel:"äºŒç­‰"},{key:"premiumSleeper",label:"é«˜çº§è½¯å§",shortLabel:"é«˜è½¯"},{key:"softSleeper",label:"è½¯å§/åŠ¨å§",shortLabel:"è½¯å§"},{key:"hardSleeper",label:"ç¡¬å§",shortLabel:"ç¡¬å§"},{key:"softSeat",label:"è½¯åº§",shortLabel:"è½¯åº§"},{key:"hardSeat",label:"ç¡¬åº§",shortLabel:"ç¡¬åº§"},{key:"noSeat",label:"æ— åº§",shortLabel:"æ— åº§"},{key:"other",label:"å…¶ä»–",shortLabel:"å…¶ä»–"}],p=j.useMemo(()=>[...l].sort((n,i)=>{let h=0;switch(u){case"departure":h=n.fromTime.localeCompare(i.fromTime);break;case"arrival":h=n.toTime.localeCompare(i.toTime);break;case"duration":{const C=S(n.duration),D=S(i.duration);h=C-D;break}case"trainNo":h=n.trainNo.localeCompare(i.trainNo);break;default:h=0}return x==="asc"?h:-h}),[l,u,x]),S=s=>{const n=s.match(/(\d+):(\d+)/);return n?parseInt(n[1])*60+parseInt(n[2]):0},a=s=>{u===s?m(x==="asc"?"desc":"asc"):(N(s),m("asc"))},g=(s,n)=>{const i=s.seats[n];return i==null?e.jsx("span",{className:"seat-unavailable",children:"--"}):i===0||i==="0"?e.jsx("span",{className:"seat-unavailable",children:"--"}):typeof i=="string"?i==="æœ‰"?e.jsx("span",{className:"seat-available",children:"æœ‰"}):i==="å€™è¡¥"?e.jsx("span",{className:"seat-waitlist",children:"å€™è¡¥"}):e.jsx("span",{className:"seat-available",children:i}):typeof i=="number"&&i>0?e.jsx("span",{className:"seat-available",children:i}):e.jsx("span",{className:"seat-unavailable",children:"--"})},T=s=>s.startsWith("G")||s.startsWith("C")?"train-type-g":s.startsWith("D")?"train-type-d":s.startsWith("Z")?"train-type-z":s.startsWith("T")?"train-type-t":s.startsWith("K")?"train-type-k":"train-type-other",b=s=>u!==s?e.jsx("span",{className:"sort-icon",children:"â†•"}):e.jsx("span",{className:`sort-icon active ${x}`,children:x==="asc"?"â†‘":"â†“"}),k=(s,n)=>n&&s&&n.localeCompare(s)<0?"æ¬¡æ—¥åˆ°è¾¾":"å½“æ—¥åˆ°è¾¾";return e.jsxs("div",{className:"train-list",children:[e.jsx("div",{className:"train-list-header",children:e.jsxs("div",{className:"header-row",children:[e.jsxs("div",{className:"train-info-header",children:[e.jsxs("div",{className:"train-no-header",onClick:()=>a("trainNo"),children:["è½¦æ¬¡ ",b("trainNo")]}),e.jsxs("div",{className:"stations-header",children:[e.jsx("div",{children:"å‡ºå‘ç«™"}),e.jsx("div",{children:"åˆ°è¾¾ç«™"})]}),e.jsxs("div",{className:"times-header",children:[e.jsxs("div",{className:"times-sort",onClick:()=>a("departure"),children:["å‡ºå‘æ—¶é—´ ",b("departure")]}),e.jsxs("div",{className:"times-sort",onClick:()=>a("arrival"),children:["åˆ°è¾¾æ—¶é—´ ",b("arrival")]})]}),e.jsxs("div",{className:"duration-header",onClick:()=>a("duration"),children:["åŽ†æ—¶ ",b("duration")]})]}),e.jsx("div",{className:"seat-headers",children:v.map(s=>e.jsx("div",{className:"seat-header",title:s.label,children:s.shortLabel},s.key))}),e.jsx("div",{className:"action-header",children:e.jsx("div",{children:"å¤‡æ³¨"})})]})}),e.jsx("div",{className:"train-list-body",children:p.map((s,n)=>e.jsxs("div",{className:"train-row",children:[e.jsxs("div",{className:"train-info",children:[e.jsx("div",{className:"train-no",children:e.jsx("span",{className:`train-type ${T(s.trainType)}`,children:s.trainNo})}),e.jsxs("div",{className:"stations-info",children:[e.jsx("div",{className:"station-line",children:e.jsx("span",{className:"station-name",children:s.fromStation})}),e.jsx("div",{className:"station-line",children:e.jsx("span",{className:"station-name",children:s.toStation})})]}),e.jsxs("div",{className:"times-info",children:[e.jsx("div",{className:"time-line",children:e.jsx("span",{className:"time",children:s.fromTime})}),e.jsx("div",{className:"time-line",children:e.jsx("span",{className:"time",children:s.toTime})}),e.jsx("div",{className:"time-line",children:e.jsx("span",{className:"arrival-note",children:k(s.fromTime,s.toTime)})})]}),e.jsx("div",{className:"duration-info",children:e.jsx("div",{className:"duration",children:s.duration})})]}),e.jsx("div",{className:"seat-info",children:v.map(i=>e.jsx("div",{className:"seat-cell",children:g(s,i.key)},i.key))}),e.jsxs("div",{className:"action-info",children:[e.jsx("div",{className:"remarks",children:s.remarks||"--"}),e.jsx("button",{className:`book-button ${s.canBook?"available":"disabled"}`,disabled:!s.canBook,onClick:()=>s.canBook&&(r==null?void 0:r(s)),children:s.canBook?"é¢„è®¢":"ä¸å¯é¢„è®¢"})]})]},`${s.trainNo}-${n}`))}),p.length===0&&e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸš„"}),e.jsx("div",{className:"empty-text",children:"æš‚æ— ç¬¦åˆæ¡ä»¶çš„è½¦æ¬¡"}),e.jsx("div",{className:"empty-hint",children:"è¯·å°è¯•è°ƒæ•´ç­›é€‰æ¡ä»¶æˆ–æ›´æ¢æ—¥æœŸ"})]})]})},pe=({isOpen:l,onClose:r,onLoginSuccess:u})=>{const[N,x]=j.useState({username:"",password:""}),[m,v]=j.useState(!1),[p,S]=j.useState(""),{login:a,refreshUser:g}=K(),T=s=>{const{name:n,value:i}=s.target;x(h=>({...h,[n]:i})),p&&S("")},b=async s=>{if(s.preventDefault(),!N.username||!N.password){S("è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ");return}v(!0),S("");try{const n=await re({username:N.username,password:N.password});n.success&&n.data?(a(n.data.user,n.data.token),await g(),r(),u&&u()):S(n.message||"ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•")}catch(n){S(n.message||"ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•")}finally{v(!1)}},k=s=>{s.target===s.currentTarget&&r()};return l?e.jsx("div",{className:"login-modal-overlay",onClick:k,children:e.jsxs("div",{className:"login-modal",children:[e.jsxs("div",{className:"login-modal-header",children:[e.jsx("h3",{children:"è¯·å…ˆç™»å½•"}),e.jsx("button",{className:"close-btn",onClick:r,children:"Ã—"})]}),e.jsxs("div",{className:"login-modal-content",children:[e.jsx("p",{className:"login-prompt",children:"æ‚¨å°šæœªç™»å½•ï¼Œè¯·å…ˆç™»å½•åŽå†è¿›è¡Œé¢„è®¢"}),e.jsxs("form",{onSubmit:b,className:"login-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"modal-username",children:"ç”¨æˆ·å"}),e.jsx("input",{id:"modal-username",type:"text",name:"username",value:N.username,onChange:T,placeholder:"è¯·è¾“å…¥ç”¨æˆ·å",disabled:m})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"modal-password",children:"å¯†ç "}),e.jsx("input",{id:"modal-password",type:"password",name:"password",value:N.password,onChange:T,placeholder:"è¯·è¾“å…¥å¯†ç ",disabled:m})]}),p&&e.jsx("div",{className:"error-message",children:p}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"cancel-btn",onClick:r,disabled:m,children:"å–æ¶ˆ"}),e.jsx("button",{type:"submit",className:"login-btn",disabled:m,children:m?"ç™»å½•ä¸­...":"ç™»å½•"})]})]}),e.jsxs("div",{className:"register-link",children:[e.jsx("span",{children:"è¿˜æ²¡æœ‰è´¦å·ï¼Ÿ"}),e.jsx("a",{href:"/register",target:"_blank",children:"ç«‹å³æ³¨å†Œ"})]})]})]})}):null},xe=()=>e.jsx("footer",{className:"footer",children:e.jsx("div",{className:"footer-container",children:e.jsxs("div",{className:"footer-bottom",children:[e.jsx("p",{children:"ç‰ˆæƒæ‰€æœ‰Â©2008-2025 ä¸­å›½é“é“ç§‘å­¦ç ”ç©¶é™¢é›†å›¢æœ‰é™å…¬å¸ æŠ€æœ¯æ”¯æŒï¼šé“æ—…ç§‘æŠ€æœ‰é™å…¬å¸"}),e.jsx("p",{children:"å…¬å®‰ äº¬å…¬ç½‘å®‰å¤‡ 11010802038392å· | äº¬ICPå¤‡05020493å·-4 | ICPè¯ï¼šäº¬B2-20202537 | è¥ä¸šæ‰§ç…§"})]})})}),je=()=>{const[l]=q(),r=J(),{isLoggedIn:u,logout:N}=K(),x=l.get("from")||"",m=l.get("to")||"",v=l.get("date")||new Date().toISOString().split("T")[0],[p,S]=j.useState([]),[a,g]=j.useState([]),[T,b]=j.useState(!0),[k,s]=j.useState(!1),[n,i]=j.useState(null),[h,C]=j.useState([]),[D,_]=j.useState([]),A=()=>{r("/profile")},$=()=>{r("/login")},O=()=>{r("/register")},o=async()=>{await N(),r("/")},y=t=>{const c={},d=t.seatInfo||{};d.å•†åŠ¡åº§&&(c.business=d.å•†åŠ¡åº§.availableSeats>0?"æœ‰":"æ— "),d.ä¸€ç­‰åº§&&(c.firstClass=d.ä¸€ç­‰åº§.availableSeats>0?"æœ‰":"æ— "),d.äºŒç­‰åº§&&(c.secondClass=d.äºŒç­‰åº§.availableSeats>0?"æœ‰":"æ— "),d.ç¡¬åº§&&(c.hardSeat=d.ç¡¬åº§.availableSeats>0?"æœ‰":"æ— "),d.ç¡¬å§&&(c.hardSleeper=d.ç¡¬å§.availableSeats>0?"æœ‰":"æ— "),d.è½¯å§&&(c.softSleeper=d.è½¯å§.availableSeats>0?"æœ‰":"æ— ");const f=Object.values(d).some(I=>I&&I.availableSeats>0),L=t.trainType==="G"||t.trainType==="C";return{trainNo:t.trainNumber,trainType:t.trainType,fromStation:t.fromStation,toStation:t.toStation,fromTime:t.departureTime,toTime:t.arrivalTime,duration:t.duration,fromStationCode:"",toStationCode:"",seats:c,canBook:f,isHighSpeed:L}};j.useEffect(()=>{(async()=>{if(!x||!m){S([]),g([]),b(!1);return}b(!0);try{const{searchTrains:c}=await X(async()=>{const{searchTrains:w}=await import("./trainService-BTylc42G.js");return{searchTrains:w}},__vite__mapDeps([0,1,2,3]));let d=h,f=D;if(d.length===0){const w=R(x);w.isCity&&w.stations.length>0&&(d=w.stations,C(w.stations))}if(f.length===0){const w=R(m);w.isCity&&w.stations.length>0&&(f=w.stations,_(w.stations))}const L={fromStation:x,toStation:m,departureDate:v};d.length>0&&(L.fromStations=d),f.length>0&&(L.toStations=f);const P=(await c(L)).map(y);S(P),g(P)}catch(c){console.error("åŠ è½½è½¦æ¬¡å¤±è´¥",c),S([]),g([])}finally{b(!1)}})()},[x,m,v,h,D]);const E=t=>{let c=[...p];if(t.departureTime&&t.departureTime!=="00:00-24:00"){const[d,f]=t.departureTime.split("-");c=c.filter(L=>L.fromTime>=d&&L.fromTime<f)}if(Array.isArray(t.trainTypes)&&t.trainTypes.length>0&&!t.trainTypes.includes("all")&&(c=c.filter(d=>t.trainTypes.some(f=>f==="GC"?d.trainType==="G"||d.trainType==="C":f==="D"?d.trainType==="D":f==="Z"?d.trainType==="Z":f==="T"?d.trainType==="T":f==="K"?d.trainType==="K":f==="fuxing"||f==="smart"?d.isHighSpeed===!0:f==="other"?!["G","C","D","Z","T","K"].includes(d.trainType):!1))),Array.isArray(t.departureStations)&&t.departureStations.length>0&&!t.departureStations.includes("all")){const d=new Set(t.departureStations);c=c.filter(f=>d.has(f.fromStation))}if(Array.isArray(t.arrivalStations)&&t.arrivalStations.length>0&&!t.arrivalStations.includes("all")){const d=new Set(t.arrivalStations);c=c.filter(f=>d.has(f.toStation))}if(Array.isArray(t.seatTypes)&&t.seatTypes.length>0){const d={business:"business",first_class_premium:"firstClassPremium",first_class:"firstClass",second_class:"secondClass",first_sleeper:"firstSleeper",second_sleeper:"secondSleeper",soft_sleeper:"softSleeper",hard_sleeper:"hardSleeper",hard_seat:"hardSeat"};c=c.filter(f=>t.seatTypes.some(L=>{const I=d[L];if(!I)return!1;const P=f.seats[I];return P!==void 0&&P!==0&&P!=="æ— "}))}g(c)},W=t=>{const c=new URLSearchParams;c.set("from",t.fromStation),c.set("to",t.toStation),c.set("date",t.departDate),r(`/trains?${c.toString()}`,{replace:!0})},Z=t=>{U(t)},U=t=>{const c=new URLSearchParams({trainNumber:t.trainNo,from:x,to:m,departureTime:t.fromTime,arrivalTime:t.toTime,date:v,duration:t.duration,seatType:"äºŒç­‰åº§",price:"553"});r(`/order?${c.toString()}`)},z=()=>{s(!1),n&&(U(n),i(null))},H=x.trim()!==""&&m.trim()!=="",Q=Array.from(new Set(p.map(t=>t.fromStation))),Y=Array.from(new Set(p.map(t=>t.toStation))),V=t=>{const c=new URLSearchParams;c.set("from",x),c.set("to",m),c.set("date",t),r(`/trains?${c.toString()}`,{replace:!0})};return e.jsxs("div",{className:"train-list-page",children:[e.jsx("header",{className:"header",children:e.jsxs("div",{className:"header-container header-top",children:[e.jsxs("div",{className:"brand",children:[e.jsx("img",{className:"brand-logo",src:"/é“è·¯12306-512x512.png",alt:"ä¸­å›½é“è·¯12306"}),e.jsxs("div",{className:"brand-text",children:[e.jsx("div",{className:"brand-title",children:"ä¸­å›½é“è·¯12306"}),e.jsx("div",{className:"brand-subtitle",children:"12306 CHINA RAILWAY"})]})]}),e.jsxs("div",{className:"header-search",children:[e.jsx("input",{className:"search-input",type:"text",placeholder:"æœç´¢è½¦ç¥¨ã€ é¤é¥®ã€ å¸¸æ—…å®¢ã€ ç›¸å…³è§„ç« "}),e.jsx("button",{className:"search-button",children:"Q"})]}),e.jsxs("div",{className:"header-links",children:[e.jsx("a",{href:"#",className:"link",children:"æ— éšœç¢"}),e.jsx("span",{className:"sep",children:"|"}),e.jsx("a",{href:"#",className:"link",children:"æ•¬è€ç‰ˆ"}),e.jsx("span",{className:"sep",children:"|"}),e.jsx("a",{href:"#",className:"link",children:"English"}),e.jsx("span",{className:"sep",children:"|"}),e.jsx("button",{className:"link-btn",onClick:A,children:"æˆ‘çš„12306"}),e.jsx("span",{className:"sep",children:"|"}),u?e.jsx("button",{className:"link-btn",onClick:o,children:"é€€å‡º"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"link-btn",onClick:$,children:"ç™»å½•"}),e.jsx("span",{className:"space"}),e.jsx("button",{className:"link-btn",onClick:O,children:"æ³¨å†Œ"})]})]})]})}),e.jsx("nav",{className:"navbar",children:e.jsx("div",{className:"nav-container",children:e.jsxs("ul",{className:"nav-links",children:[e.jsx("li",{children:e.jsx("a",{href:"/",children:"é¦–é¡µ"})}),e.jsx("li",{children:e.jsx("a",{href:"/trains",className:"active",children:"è½¦ç¥¨"})}),e.jsx("li",{children:e.jsx("a",{href:"#",children:"å›¢è´­æœåŠ¡"})}),e.jsx("li",{children:e.jsx("a",{href:"#",children:"ä¼šå‘˜æœåŠ¡"})}),e.jsx("li",{children:e.jsx("a",{href:"#",children:"ç«™è½¦æœåŠ¡"})}),e.jsx("li",{children:e.jsx("a",{href:"#",children:"å•†æ—…æœåŠ¡"})}),e.jsx("li",{children:e.jsx("a",{href:"#",children:"å‡ºè¡ŒæŒ‡å—"})}),e.jsx("li",{children:e.jsx("a",{href:"#",children:"ä¿¡æ¯æŸ¥è¯¢"})})]})})}),e.jsx(he,{fromStation:x,toStation:m,departDate:v,passengerType:"adult",trainType:"all",onConditionsChange:W,onStationFilterChange:t=>{C(t.fromStations||[]),_(t.toStations||[])}}),e.jsx(me,{currentDate:v,fromStation:x,toStation:m,availableDepartureStations:Q,availableArrivalStations:Y,onFiltersChange:E,onDateSelect:V}),e.jsx("div",{className:"main-content",children:e.jsx("div",{className:"content",children:H&&(T?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("div",{className:"loading-text",children:"æ­£åœ¨æŸ¥è¯¢è½¦æ¬¡ä¿¡æ¯..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"result-summary",children:[e.jsxs("span",{className:"result-count",children:["å…±æ‰¾åˆ° ",e.jsx("strong",{children:a.length})," è¶Ÿè½¦æ¬¡"]}),e.jsxs("div",{className:"result-tips",children:[e.jsx("span",{className:"tip-item",children:"ðŸŸ¢ æœ‰ç¥¨"}),e.jsx("span",{className:"tip-item",children:"ðŸŸ  å€™è¡¥"}),e.jsx("span",{className:"tip-item",children:"âšª æ— ç¥¨"})]})]}),e.jsx(ue,{trains:a,onTrainSelect:Z})]}))})}),e.jsx(pe,{isOpen:k,onClose:()=>s(!1),onLoginSuccess:z}),e.jsx(xe,{})]})},fe=()=>e.jsx(ce,{children:e.jsx(je,{})}),Ne=Object.freeze(Object.defineProperty({__proto__:null,default:fe},Symbol.toStringTag,{value:"Module"}));export{Ne as T,ae as g};
